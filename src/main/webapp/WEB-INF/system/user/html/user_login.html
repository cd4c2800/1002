<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>登录</title>
<!-- BEGIN GLOBAL MANDATORY STYLES -->
        <link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700&subset=all" rel="stylesheet" type="text/css" />
        <link href="$!webPath/resources/assets/global/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
        <link href="$!webPath/resources/assets/global/plugins/simple-line-icons/simple-line-icons.min.css" rel="stylesheet" type="text/css" />
        <link href="$!webPath/resources/assets/global/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
        <link href="$!webPath/resources/assets/global/plugins/bootstrap-switch/css/bootstrap-switch.min.css" rel="stylesheet" type="text/css" />
        <!-- END GLOBAL MANDATORY STYLES -->
        <!-- BEGIN PAGE LEVEL PLUGINS -->
        <link href="$!webPath/resources/assets/global/plugins/select2/css/select2.min.css" rel="stylesheet" type="text/css" />
        <link href="$!webPath/resources/assets/global/plugins/select2/css/select2-bootstrap.min.css" rel="stylesheet" type="text/css" />
        <!-- END PAGE LEVEL PLUGINS -->
        <!-- BEGIN THEME GLOBAL STYLES -->
        <link href="$!webPath/resources/assets/global/css/components.min.css" rel="stylesheet" id="style_components" type="text/css" />
        <link href="$!webPath/resources/assets/global/css/plugins.min.css" rel="stylesheet" type="text/css" />
        <!-- END THEME GLOBAL STYLES -->
        <!-- BEGIN PAGE LEVEL STYLES -->
        <link href="$!webPath/resources/assets/pages/css/login.min.css" rel="stylesheet" type="text/css" />
        <!-- END PAGE LEVEL STYLES -->
        <!-- BEGIN THEME LAYOUT STYLES -->
        <!-- END THEME LAYOUT STYLES -->
        <link rel="shortcut icon" href="favicon.ico" /> 
        

</head>
<body class=" login">
        <!-- BEGIN LOGO -->
        <div class="logo">
            <a href="index.html">
                <img src="$!webPath/resources/assets/pages/img/logo-big.png" alt="" /> </a>
        </div>
        <!-- END LOGO -->
        <!-- BEGIN LOGIN -->
        <div class="content">
            <!-- BEGIN LOGIN FORM -->
            <form class="login-form" action="" method="post" id="login">
                <h3 class="form-title font-green">登录</h3>
                <div class="alert alert-danger display-hide">
                    <button class="close" data-close="alert"></button>
                    <span> 输入用户名和密码 </span>
                </div>
                <div class="form-group">
                    <!--ie8, ie9 does not support html5 placeholder, so we just show field title for that-->
                    <label class="control-label visible-ie8 visible-ie9">账号</label>
                    <input class="form-control form-control-solid placeholder-no-fix" type="text" autocomplete="off" placeholder="请输入账号" name="userName"  id="userName"/> </div>
                <div class="form-group">
                    <label class="control-label visible-ie8 visible-ie9">密码</label>
                    <input class="form-control form-control-solid placeholder-no-fix" type="password" autocomplete="off" placeholder="请输入密码" name="password" id="password" /> </div>
                <div class="form-actions">
                    <button type="button" onclick="login();"  class="btn green uppercase">登录</button>
                   
                    <a href="javascript:;" id="forget-password" class="forget-password">忘记密码?</a>
                </div>
                
                <div class="create-account">
                    <p>
                        <a href="javascript:;" id="register-btn" class="uppercase">创建一个账户</a>
                    </p>
                </div>
            </form>
            <!-- END LOGIN FORM -->
            
            <!-- BEGIN REGISTRATION FORM -->
            <form class="register-form"  method="post">
                <h3 class="font-green">注册</h3>
                <p class="hint"> 在下面输入您的个人信息: </p>
                
                <div class="form-group">
                    <!--ie8, ie9 does not support html5 placeholder, so we just show field title for that-->
                    <label class="control-label visible-ie8 visible-ie9">Email</label>
                    <input class="form-control placeholder-no-fix" type="text" placeholder="请输入邮箱" name="email" id="email" /> </div>
                 <div class="form-group">
                    <label class="control-label visible-ie8 visible-ie9">验证码</label>
                    <input class="form-control placeholder-no-fix" type="text" autocomplete="off" placeholder="请输入验证码" name="code" id="code" style="width: 50%;float: left;margin-bottom: 15px;"/> 
                    <input type="button" class="btn green btn-outline" value="点击发送验证码" onclick="sendCode(this)" style="float: left;margin-left: 10px;padding: 10px 10px;"/></div>
                <div class="form-group">
                    <label class="control-label visible-ie8 visible-ie9">用户名</label>
                    <input class="form-control placeholder-no-fix" type="text" autocomplete="off" placeholder="请输入用户名" name="username" id="username_t"/> </div>
                <div class="form-group">
                    <label class="control-label visible-ie8 visible-ie9">密码</label>
                    <input class="form-control placeholder-no-fix" type="password" autocomplete="off" id="register_password" placeholder="请输入密码" name="password" /> </div>
                <div class="form-group">
                    <label class="control-label visible-ie8 visible-ie9">重复密码</label>
                    <input class="form-control placeholder-no-fix" type="password" autocomplete="off" placeholder="请输入重复密码" name="rpassword" id="rpassword" /> </div>
                <div class="form-group margin-top-20 margin-bottom-20">
                    <label class="mt-checkbox mt-checkbox-outline">
                        <input type="checkbox" name="tnc" /> 我已阅读并同意
                        <a href="javascript:;">服务条款 </a> 和
                        <a href="javascript:;">隐私政策 </a>
                        <span></span>
                    </label>
                    <div id="register_tnc_error"> </div>
                </div>
                <div class="form-actions">
                    <button type="button" id="register-back-btn" class="btn green btn-outline">返回</button>
                    <div   class="btn btn-success uppercase pull-right" onclick="register()">提交</div>
                </div>
            </form>
            <!-- END REGISTRATION FORM -->
            
            
            <!-- BEGIN REGISTRATION FORM -->
            <form class="forget-form"  method="post">
                <h3 class="font-green">忘记密码</h3>
                <p class="hint"> 在下面输入您的个人信息: </p>
                
                <div class="form-group">
                    <!--ie8, ie9 does not support html5 placeholder, so we just show field title for that-->
                    <label class="control-label visible-ie8 visible-ie9">Email</label>
                    <input class="form-control placeholder-no-fix" type="text" placeholder="请输入邮箱" name="email_forget" id="email_forget" /> </div>
                 <div class="form-group">
                    <label class="control-label visible-ie8 visible-ie9">验证码</label>
                    <input class="form-control placeholder-no-fix" type="text" autocomplete="off" placeholder="请输入验证码" name="code_forget" id="code_forget" style="width: 50%;float: left;margin-bottom: 15px;"/> 
                    <input type="button" class="btn green btn-outline" value="点击发送验证码" onclick="sendCode_forget(this)" style="float: left;margin-left: 10px;padding: 10px 10px;"/></div>
                <div class="form-group">
                    <label class="control-label visible-ie8 visible-ie9">密码</label>
                    <input class="form-control placeholder-no-fix" type="password" autocomplete="off" id="forget_password" placeholder="请输入密码" name="forget_password" /> </div>
                <div class="form-group">
                    <label class="control-label visible-ie8 visible-ie9">重复密码</label>
                    <input class="form-control placeholder-no-fix" type="password" autocomplete="off" placeholder="请输入重复密码" name="forget_rpassword" id="forget_rpassword" /> </div>
                <div class="form-group margin-top-20 margin-bottom-20">
                    <label class="mt-checkbox mt-checkbox-outline">
                        <input type="checkbox" name="tnc" /> 我已阅读并同意
                        <a href="javascript:;">服务条款 </a> 和
                        <a href="javascript:;">隐私政策 </a>
                        <span></span>
                    </label>
                    <div id="register_tnc_error"> </div>
                </div>
                <div class="form-actions">
                    <button type="button" id="register-back-btn" class="btn green btn-outline">返回</button>
                    <div   class="btn btn-success uppercase pull-right" onclick="forget()">提交</div>
                </div>
            </form>
            <!-- END REGISTRATION FORM -->
            
            
        </div>
        <div class="copyright"> 2014 © Metronic. Admin Dashboard Template. </div>
        <!--[if lt IE 9]>
<script src="$!webPath/resources/assets/global/plugins/respond.min.js"></script>
<script src="$!webPath/resources/assets/global/plugins/excanvas.min.js"></script> 
<script src="$!webPath/resources/assets/global/plugins/ie8.fix.min.js"></script> 
<![endif]-->
        <!-- BEGIN CORE PLUGINS -->
        <script src="$!webPath/resources/js/jquery-1.12.2.min.js" type="text/javascript"></script>
        <script src="$!webPath/resources/assets/global/plugins/jquery.min.js" type="text/javascript"></script>
        <script src="$!webPath/resources/assets/global/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
        <script src="$!webPath/resources/assets/global/plugins/js.cookie.min.js" type="text/javascript"></script>
        <script src="$!webPath/resources/assets/global/plugins/jquery-slimscroll/jquery.slimscroll.min.js" type="text/javascript"></script>
        <script src="$!webPath/resources/assets/global/plugins/jquery.blockui.min.js" type="text/javascript"></script>
        <script src="$!webPath/resources/assets/global/plugins/bootstrap-switch/js/bootstrap-switch.min.js" type="text/javascript"></script>
        <!-- END CORE PLUGINS -->
        <!-- BEGIN PAGE LEVEL PLUGINS -->
        <script src="$!webPath/resources/assets/global/plugins/jquery-validation/js/jquery.validate.min.js" type="text/javascript"></script>
        <script src="$!webPath/resources/assets/global/plugins/jquery-validation/js/additional-methods.min.js" type="text/javascript"></script>
        <script src="$!webPath/resources/assets/global/plugins/select2/js/select2.full.min.js" type="text/javascript"></script>
        <!-- END PAGE LEVEL PLUGINS -->
        <!-- BEGIN THEME GLOBAL SCRIPTS -->
        <script src="$!webPath/resources/assets/global/scripts/app.min.js" type="text/javascript"></script>
        <!-- END THEME GLOBAL SCRIPTS -->
        <!-- BEGIN PAGE LEVEL SCRIPTS -->
        <script src="$!webPath/resources/assets/pages/scripts/login.js" type="text/javascript"></script>
        <!-- END PAGE LEVEL SCRIPTS -->
        <!-- BEGIN THEME LAYOUT SCRIPTS -->
        <!-- END THEME LAYOUT SCRIPTS -->
        <script src="$!webPath/resources/js/layer/layer.js"></script>
        
 <script type="text/javascript">
 
	 var clock = '';
	 var nums = 60;
	 var btn;
	 function sendCode(thisBtn)
	 {
		// alert(jQuery("#email").val());
		 jQuery.ajax({
			  url: "$!webPath/user/getEmail.htm",     
			    type: "post",               
			    data: {"email":jQuery("#email").val()},
			    dataType: "json",      
			    success:function(data){
			    	if(data.status == 'success'){
			    		 btn = thisBtn;
			    		 btn.disabled = true; //将按钮置为不可点击
			    		 btn.value = nums+'秒后可重新获取';
			    		 clock = setInterval(doLoop, 1000); //一秒执行一次
			    	}else if(data.status == 'error'){
			    		layer.msg("邮箱不能为空！");
			    	}else if(data.msg == 101){
			    		layer.msg("账号已存在！");
			    	}
			    	
			    }
		}); 
	 }
	 
	 function sendCode_forget(thisBtn)
	 {
		// alert(jQuery("#email").val());
		 jQuery.ajax({
			  url: "$!webPath/user/updateEmail.htm",     
			    type: "post",               
			    data: {"email":jQuery("#email_forget").val()},
			    dataType: "json",      
			    success:function(data){
			    	if(data.status == 'success'){
			    		 btn = thisBtn;
			    		 btn.disabled = true; //将按钮置为不可点击
			    		 btn.value = nums+'秒后可重新获取';
			    		 clock = setInterval(doLoop, 1000); //一秒执行一次
			    	}else if(data.status == 'error'){
			    		layer.msg("邮箱不能为空！");
			    	}else if(data.msg == 101){
			    		layer.msg("邮箱不存在！");
			    	}
			    	
			    }
		}); 
	 } 
	 
	 function doLoop()
	 {
		 nums--;
		 if(nums > 0){
		  	btn.value = nums+'秒后可重新获取';
		 }else{
			  clearInterval(clock); //清除js定时器
			  btn.disabled = false;
			  btn.value = '点击发送验证码';
			  nums = 10; //重置时间
		 }
	 }
	 
function login(){	
	jQuery.ajax({
		  url: "$!webPath/user/loginS.htm",     
		    type: "post",               
		    data: {"userName":jQuery("#userName").val(),"password":jQuery("#password").val()},
		    dataType: "json",      
		    success:function(data){
		    	if(data.status == 'success'){
		    		location.href='$!webPath' +data.url;
		    	}else if(data.msg == 119){
		    		layer.msg("用户名或密码有误！");
		    	}else if(data.msg == 120){
		    		layer.msg("用户名不存在！");
		    	}
		    	
		    }
	});
}


function register(){
	jQuery.ajax({
		  url: "$!webPath/user/registerJson.htm",     
		    type: "post",               
		    data: {"username":jQuery("#username_t").val(),"password":jQuery("#register_password").val(),"password_now":jQuery("#rpassword").val(),"code":jQuery("#code").val(),"email":jQuery("#email").val()},
		    dataType: "json",      
		    success:function(data){		    	
		    	if(data.status == 'success'){
		    		location.href='$!webPath' +data.url;
		    	}else if(data.msg == 101){
		    		layer.msg("用户名已存在！");
		    	}else if(data.msg == 102){
		    		layer.msg("用户名不能为空！");
		    	}else if(data.msg == 103){
		    		layer.msg("邮箱已存在！");
		    	}else if(data.msg == 104){
		    		layer.msg("获取的验证码不存在！");
		    	}else if(data.msg == 98){
		    		layer.msg("验证码不正确！");
		    	}else if(data.msg == 106){
		    		layer.msg("验证码不能为空！");
		    	}else if(data.msg == 107){
		    		layer.msg("昵称已注册！");
		    	}else if(data.msg == 108){
		    		layer.msg("昵称不能为空！");
		    	}else if(data.msg == 109){
		    		layer.msg("密码不能为空！");
		    	}else if(data.msg == 99){
		    		layer.msg("密码不匹配！");
		    	}
		    	
		    }
	});
}	 

function forget(){
	jQuery.ajax({
		  url: "$!webPath/user/updatePassword.htm",     
		    type: "post",               
		    data: {"newPwd":jQuery("#forget_password").val(),"newPwdTow":jQuery("#forget_rpassword").val(),"code":jQuery("#code_forget").val(),"email":jQuery("#email_forget").val()},
		    dataType: "json",      
		    success:function(data){
		    	if(data.status == 'success'){
		    		layer.msg("修改成功！");
		    		location.href='$!webPath' +data.url;
		    	}else if(data.msg == 103){
		    		layer.msg("邮箱已存在！");
		    	}else if(data.msg == 104){
		    		layer.msg("获取的验证码不存在！");
		    	}else if(data.msg == 98){
		    		layer.msg("验证码不正确！");
		    	}else if(data.msg == 106){
		    		layer.msg("验证码不能为空！");
		    	}else if(data.msg == 107){
		    		layer.msg("昵称已注册！");
		    	}else if(data.msg == 108){
		    		layer.msg("昵称不能为空！");
		    	}else if(data.msg == 109){
		    		layer.msg("密码不能为空！");
		    	}else if(data.msg == 99){
		    		layer.msg("密码不匹配！");
		    	}
		    	
		    }
	});
}	
</script>
<script>

</script>
    </body>
</html>
